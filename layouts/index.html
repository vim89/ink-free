<!DOCTYPE html>
<html lang="{{ .Site.Language.Lang }}" data-theme-mode="{{ .Site.Params.mode | default "auto" }}"{{- if (eq .Site.Params.mode "dark" ) -}} class="dark"{{ end }}>
{{ partial "header.html" . }}

<body>
	{{- /* WCAG 2.2 Level A: Skip link for keyboard navigation */ -}}
	<a href="#main-content" class="skip-link">Skip to main content</a>

	<div class="container wrapper">
		<header class="site-header">
			{{ partial "head.html" . }}
		</header>

		<main role="main" aria-label="Blog posts" id="main-content">
			<section class="recent-posts section">
				<h1 class="visually-hidden">Recent Posts</h1>
				<div class="posts">
					{{ $pages := where .Site.RegularPages "Type" "in" .Site.Params.mainSections }}
					{{ $filteredPages := where $pages "Params.hidden" "ne" true }}

					{{- /* Separate pinned and regular posts */ -}}
					{{ $pinnedPages := where $filteredPages "Params.pinned" true }}
					{{ $regularPages := where $filteredPages "Params.pinned" "ne" true }}

					{{- /* Sort both by date, but keep them separate */ -}}
					{{ $sortedPinned := $pinnedPages.ByDate.Reverse }}
					{{ $sortedRegular := $regularPages.ByDate.Reverse }}

					{{- /* Combine: pinned first, then regular */ -}}
					{{ $combinedPages := slice }}
					{{ range $sortedPinned }}
						{{ $combinedPages = $combinedPages | append . }}
					{{ end }}
					{{ range $sortedRegular }}
						{{ $combinedPages = $combinedPages | append . }}
					{{ end }}

					{{ $paginator := .Paginate $combinedPages }}
					{{ range $paginator.Pages }}
				<div class="post">
					<div class="post-header">
						<div class="meta">
							<div class="date">
								<span class="day">{{ dateFormat "02" .Date }}</span>
								<span class="rest">{{ if $.Site.Data.month }}{{ index $.Site.Data.month (printf "%d"
									.Date.Month) }} {{ .Date.Year }}{{ else }}{{ dateFormat "Jan 2006" .Date }}{{ end
								}}</span>
							</div>
						</div>
						<div class="matter">
							<h2 class="title small">
								<a href="{{ .RelPermalink }}">{{ if .Params.pinned }}<span class="pinned-icon" title="Pinned Post">ðŸ“Œ</span> {{ end }}{{.Title}}{{ if .Draft }}<sup
									class="draft-label">DRAFT</sup>{{ end }}</a>
							</h2>
							{{ $wc := 0 }}
							{{ with .WordCount }}{{ $wc = . }}{{ end }}
							{{ if eq $wc 0 }}{{ $wc = countwords (default "" .Plain) }}{{ end }}
							<div class="meta-info small smaller">
								{{ $wc | lang.FormatNumberCustom 0 }} words,
								{{ $wpm := cond (gt (int .Site.Params.wpm) 0) (int .Site.Params.wpm) 250 }}
								~{{ div (int $wc) $wpm }} min read
							</div>
							<div class="tags-section small smaller">
								{{ with .Params.tags }}
								<ul class="tags flat">
									{{ range . }}
									<li class="tag-li">
									<a href="{{ (printf "/tags/%s/" (. | urlize)) | relLangURL }}" aria-label="Tag: {{ . }}">{{ . }}</a>
									</li>
									{{ end }}
								</ul>
								{{ end }}
							</div>
							<span class="description">
								{{ if isset .Params "description" }}
								{{ .Description }}
								{{ else if gt (len .RawContent) 120 }}
								{{ slicestr .RawContent 0 120 }}...
								{{ else }}
								{{ .RawContent }}
								{{ end }}
							</span>
						</div>
					</div>
				</div>
					{{ end }}
					{{ template "partials/paginator.html" . }}
				</div>
			</section>
		</main>
	</div>

	<footer class="site-footer">
		{{ partial "footer.html" . }}
	</footer>
</body>

</html>
