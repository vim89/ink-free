<!DOCTYPE html>
<html lang="{{ .Site.Language.Lang }}" data-theme-mode="{{ .Site.Params.mode | default "auto" }}"{{- if (eq .Site.Params.mode "dark") -}} class="dark"{{ end }}>
{{ partial "header.html" . }}

<body>
	{{- /* WCAG 2.2 Level A: Skip link for keyboard navigation */ -}}
	<a href="#main-content" class="skip-link">Skip to main content</a>

	<div class="container wrapper list">
		{{ partial "head.html" . }}

		{{ if isset .Data "Term" }}
			<h2 id="main-content">{{ .Data.Term }}</h2>
		{{ else }}
		<h2 class="page-title" id="main-content">{{ .Name }}</h2>
		{{ end }}

		{{ if .Content }}
		<div class="list-content">
			{{ .Content }}
		</div>
		{{ end }}

		<ul class="posts flat">
			{{- /* Separate pinned and regular posts */ -}}
			{{ $pinnedPages := where .Data.Pages "Params.pinned" true }}
			{{ $regularPages := where .Data.Pages "Params.pinned" "ne" true }}

			{{- /* Sort both by date */ -}}
			{{ $sortedPinned := $pinnedPages.ByDate.Reverse }}
			{{ $sortedRegular := $regularPages.ByDate.Reverse }}

			{{- /* Combine: pinned first, then regular */ -}}
			{{ $allPages := slice }}
			{{ range $sortedPinned }}
				{{ $allPages = $allPages | append . }}
			{{ end }}
			{{ range $sortedRegular }}
				{{ $allPages = $allPages | append . }}
			{{ end }}

			{{- range $allPages -}}
			{{- if (in (.Site.Params.excludedTypes | default (slice "page")) .Type) -}}
			{{- else -}}
			<li class="post">
				<div class="post-header">
					<div class="meta">
						<div class="date">
							<span class="day">{{ dateFormat "02" .Date }}</span>
							<span class="rest">{{ if $.Site.Data.month }}{{ index $.Site.Data.month (printf "%d" .Date.Month) }} {{ .Date.Year }}{{ else }}{{ dateFormat "Jan 2006" .Date }}{{ end }}</span>
						</div>
					</div>
					<div class="matter">
						<h3 class="title small">
							<a href="{{ .RelPermalink }}">{{ if .Params.pinned }}<span class="pinned-icon" title="Pinned Post">ðŸ“Œ</span> {{ end }}{{.Title}}{{ if .Draft }}<sup class="draft-label">DRAFT</sup>{{ end }}</a>
						</h3>
						<span class="description">
							{{ if isset .Params "description" }}
								{{ .Description }}
							{{ else if gt (len .RawContent) 120 }}
								{{ slicestr .RawContent 0 120 }}...
							{{ else }}
								{{ .RawContent }}
							{{ end }}
						</span>
					</div>
				</div>
			</li>
			{{- end -}}
			{{- end -}}
		</ul>
	</div>

	{{ partial "footer.html" . }}
</body>

</html>
